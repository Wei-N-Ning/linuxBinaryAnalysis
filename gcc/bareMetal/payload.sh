#!/usr/bin/env bash

# this payload is created from the same main-less C
# program with all the debug symbols and comments
# stripped

# see my note in Linux Software Exploit notebook about
# a better payload packing technique

function decode() {
    echo "
f0VMRgIBAQAAAAAAAAAAAAIAPgABAAAARAFAAAAAAABAAAAAAAAAAOABAAAAAAAA
AAAAAEAAOAAEAEAABgAFAAEAAAAFAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAA
oAEAAAAAAACgAQAAAAAAAAAAIAAAAAAABAAAAAQAAAAgAQAAAAAAACABQAAAAAAA
IAFAAAAAAAAkAAAAAAAAACQAAAAAAAAABAAAAAAAAABQ5XRkBAAAAFQBAAAAAAAA
VAFAAAAAAABUAUAAAAAAABQAAAAAAAAAFAAAAAAAAAAEAAAAAAAAAFHldGQGAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAA
BAAAABQAAAADAAAAR05VAA7bPyhqORhICQi8kvOp2SKm6kOIVUiJ5bgBAAAAMdvN
gJBdwwEbAzsQAAAAAQAAAPD///8sAAAAFAAAAAAAAAABelIAAXgQARsMBwiQAQAA
HAAAABwAAAC8////EAAAAABBDhCGAkMNBksMBwgAAAAALnNoc3RydGFiAC5ub3Rl
LmdudS5idWlsZC1pZAAudGV4dAAuZWhfZnJhbWVfaGRyAC5laF9mcmFtZQAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAsAAAAHAAAAAgAAAAAAAAAgAUAAAAAAACABAAAAAAAA
JAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAeAAAAAQAAAAYAAAAAAAAA
RAFAAAAAAABEAQAAAAAAABAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAA
JAAAAAEAAAACAAAAAAAAAFQBQAAAAAAAVAEAAAAAAAAUAAAAAAAAAAAAAAAAAAAA
BAAAAAAAAAAAAAAAAAAAADIAAAABAAAAAgAAAAAAAABoAUAAAAAAAGgBAAAAAAAA
OAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAA
AAAAAAAAAACgAQAAAAAAADwAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAA
    " | openssl base64 -d > /tmp/_
    chmod 777 /tmp/_
}

/tmp/_
echo $?
